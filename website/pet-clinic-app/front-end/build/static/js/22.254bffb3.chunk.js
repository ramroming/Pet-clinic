(this["webpackJsonppet-clinic-app"]=this["webpackJsonppet-clinic-app"]||[]).push([[22],{274:function(e,t,a){"use strict";a.r(t);var r=a(8),n=a.n(r),c=a(11),s=a(4),l=a(44),o=(a(54),a(1)),i=a(56),d=a(55),u=a(267),p=a(63),j=a(62),b=a(38),h=a(34),f=a(0),m=p.a,O=new Date,g=Object(h.a)(O,"isoDate"),x=Object(h.a)(O.setMonth(O.getMonth()-360),"isoDate"),v=function(e){e.setOpenEditModal;var t=e.state,a=e.dispatch;return Object(f.jsx)(d.a,{children:Object(f.jsx)(u.a.form,{variants:m,initial:"initial",animate:"final",exit:"exit",className:"profile-data edit-side-form flex-col falign-center gap-24p",children:Object(f.jsxs)("div",{className:"inputs-wrapper flex-col  falign-center gap-16p",children:[Object(f.jsxs)("div",{className:"input-wrapper",children:[Object(f.jsx)("label",{className:"half-label",htmlFor:"name",children:"Pet Name:*"}),Object(f.jsx)("input",{type:"text",name:"name",id:"name",value:t.name.value,onChange:function(e){a({type:"enterValue",value:e.currentTarget.value,field:"name"})}})]}),Object(f.jsxs)("div",{style:{width:"fit-content"},className:"gender-input-wrapper flex-row gap-8p",children:[Object(f.jsx)("label",{className:"",htmlFor:"gender",children:"Pet Gender:"}),Object(f.jsx)("input",{type:"radio",name:"gender",id:"male",value:"male",onChange:function(e){a({type:"enterValue",value:e.currentTarget.value,field:"gender"})},checked:"male"===t.gender.value}),Object(f.jsx)("label",{className:"",htmlFor:"male",children:"Male"}),Object(f.jsx)("input",{type:"radio",name:"gender",id:"female",value:"female",onChange:function(e){a({type:"enterValue",value:e.currentTarget.value,field:"gender"})},checked:"female"===t.gender.value}),Object(f.jsx)("label",{className:"",htmlFor:"female",children:"Female"})]}),Object(f.jsxs)("div",{className:"input-wrapper  ",children:[Object(f.jsx)("label",{className:"half-label",htmlFor:"birth_date",children:"Birth Date:*"}),Object(f.jsx)("input",{onChange:function(e){a({type:"enterValue",value:e.currentTarget.value,field:"birth_date"})},value:Object(h.a)(t.birth_date.value,"isoDate"),min:x,max:g,type:"date",name:"birth_date",id:"birth_date"})]}),Object(f.jsxs)("div",{className:"input-wrapper upload-pet",children:[Object(f.jsx)("label",{className:"half-label",children:"Photo:"}),Object(f.jsxs)("label",{htmlFor:"photo",className:"btn-r btn-r-outlined-blue ",children:["Press to upload\xa0",Object(f.jsx)("i",{className:"fas fa-upload"})]}),Object(f.jsx)("input",{onChange:function(e){if(0!==e.currentTarget.files.length)return a({type:"uploadPhoto",field:"photo",value:e.currentTarget.files[0],url:URL.createObjectURL(e.currentTarget.files[0])})},type:"file",name:"photo",id:"photo",accept:".png, .jpg, .jpeg"}),t.photo.errorMsg&&Object(f.jsx)(b.a,{style:{left:"40%"},class:"error-msg",msg:t.photo.errorMsg})]}),t.photo.url&&Object(f.jsx)(j.a,{fileURL:t.photo.url,fileName:t.photo.value.name,fileSize:Math.round(t.photo.value.size/1e3)}),!t.photo.url&&t.pets.length&&Object(f.jsx)("div",{className:"photo-info-wrapper flex-row gap-32p falign-center",children:Object(f.jsx)("img",{alt:"miniphoto",className:"mini-pet-photo",src:t.pets[t.petIndex].photo?URL.createObjectURL(new Blob([new Uint8Array(t.pets[t.petIndex].photo.data)])):"/media/imgs/cat.png"})}),Object(f.jsxs)("div",{className:"input-wrapper ",children:[Object(f.jsx)("label",{className:"half-label",htmlFor:"breed_name",children:"Select Breed:*"}),0!==t.breeds.length&&Object(f.jsxs)("select",{onChange:function(e){return a({type:"enterValue",field:"breed_name",value:e.currentTarget.value})},name:"breed_name",id:"breed_name",defaultValue:t.selectedPet.breed_name,children:[Object(f.jsx)("option",{value:"",children:"Select a Breed"}),t.breeds&&t.breeds.map((function(e,t){return Object(f.jsx)("option",{value:e.name,children:e.name},t)}))]})]}),Object(f.jsxs)("div",{className:"input-wrapper flex-row",children:[Object(f.jsx)("label",{className:"half-label",htmlFor:"breed_name",children:"Select Colors max 3:*"}),t.colors&&0!==t.colors.length&&!t.isLoadingColors&&t.selectedColors&&t.colors.map((function(e,r){return Object(f.jsx)("div",{className:0!==t.selectedColors.length&&t.selectedColors.includes(e.name)?"color-tag color-selected":"color-tag",children:Object(f.jsx)("p",{onClick:function(e){!function(e){a({type:"selectColor",color:e.target.innerHTML})}(e)},colorid:r,children:e.name})},r)}))]}),t.missingInput&&Object(f.jsx)("p",{style:{color:"red",textAlign:"center",width:"70%",margin:"auto"},children:"Please Fill mandatory fields *"}),Object(f.jsx)("button",{onClick:function(){return a({type:"validate"})},type:"button",className:"btn-r btn-r-blue",children:"Update Pet's Info"})]})})})},y=a(60),C=a(27),P=a(31),T=function(e,t){switch(t.type){case"successFetchPets":return Object(P.a)(Object(P.a)({},e),{},{isFetchingPets:!1,fetchPetsFailure:"",pets:t.data});case"failureFetchPets":return Object(P.a)(Object(P.a)({},e),{},{isFetchingPets:!1,fetchPetsFailure:t.error});case"errorModalExit":return Object(P.a)(Object(P.a)({},e),{},{fetchPetsFailure:"",responseError:""});case"enterValue":return Object(P.a)(Object(P.a)({},e),{},Object(C.a)({},t.field,Object(P.a)(Object(P.a)({},e[t.field]),{},{value:t.value})));case"uploadPhoto":return t.value.size>1e7?Object(P.a)(Object(P.a)({},e),{},Object(C.a)({},t.field,{value:"",url:"",errorMsg:"Image too big!"})):Object(P.a)(Object(P.a)({},e),{},Object(C.a)({},t.field,{value:t.value,url:t.url,errorMsg:""}));case"successGetPetData":return Object(P.a)(Object(P.a)({},e),{},{isLoadingPets:!1,getPetsResult:t.data});case"selectPet":return Object(P.a)(Object(P.a)({},e),{},{petIndex:t.index,isLoadingBreeds:!0,isUpdating:!1,missingInput:!1,breeds:[],selectedPet:t.data,pet_type:t.data.type_name,selectedColors:[],name:{value:t.data.name,errorMsg:""},gender:{value:t.data.gender,errorMsg:""},birth_date:{value:Object(h.a)(t.data.birth_date,"UTC:yyyy-mm-dd"),errorMsg:""},photo:{url:"",value:"",errorMsg:""},breed_name:{value:t.data.breed_name,errorMsg:""},showUpdateMenu:!0});case"getBreedsSuccess":return Object(P.a)(Object(P.a)({},e),{},{responseError:"",isLoadingBreeds:!1,breeds:t.data});case"getColors":return Object(P.a)(Object(P.a)({},e),{},{isLoadingColors:!0});case"getColorsSuccess":return Object(P.a)(Object(P.a)({},e),{},{responseError:"",isLoadingColors:!1,colors:t.data});case"selectColor":return-1!==e.selectedColors.indexOf(t.color)?Object(P.a)(Object(P.a)({},e),{},{selectedColors:e.selectedColors.filter((function(e){return e!==t.color}))}):3===e.selectedColors.length?e:Object(P.a)(Object(P.a)({},e),{},{selectedColors:[].concat(Object(y.a)(e.selectedColors),[t.color])});case"validate":if(e.isUpdating)return e;if(!e.name.value||!e.breed_name.value||0===e.selectedColors.length)return Object(P.a)(Object(P.a)({},e),{},{missingInput:!0});if(e.photo.errorMsg)return Object(P.a)(Object(P.a)({},e),{},{missingInput:!1});var a=new FormData;return a.append("name",e.name.value),a.append("gender",e.gender.value),a.append("birth_date",e.birth_date.value),a.append("pet_type",e.pet_type),a.append("breed_name",e.breed_name.value),a.append("photo",e.photo.value),a.append("colors",e.selectedColors.join(":")),Object(P.a)(Object(P.a)({},e),{},{dataToUpdate:a,isUpdating:!0,missingInput:!1});case"successUpdate":return Object(P.a)(Object(P.a)({},e),{},{isUpdating:!1,updateResult:t.data});case"failure":return Object(P.a)(Object(P.a)({},e),{},{isLoadingPets:!1,isLoadingBreeds:!1,isLoadingColors:!1,isUpdating:!1,responseError:t.error});case"selectToDelete":return Object(P.a)(Object(P.a)({},e),{},{petToDelete:t.deleteId});case"startDeleting":return Object(P.a)(Object(P.a)({},e),{},{isDeletingPet:!0,deletePetResult:"",deletePetFailure:""});case"deletePetSuccess":return Object(P.a)(Object(P.a)({},e),{},{isDeletingPet:!1,deletePetResult:t.data.result,deletePetFailure:""});case"deletePetFailure":return Object(P.a)(Object(P.a)({},e),{},{isDeletingPet:!1,deletePetFailure:t.error})}},N=function(e){var t=Object(o.useReducer)(T,e),a=Object(s.a)(t,2);return[a[0],a[1]]},w=a(12),k=a(30),_=a(6),F=a(33),D=new Date,M={openModal:!1,openEditModal:!1,isFetchingPets:!0,fetchPetsFailure:"",pets:[],responseError:"",missingInput:!1,isUpdating:!1,isLoadingBreeds:!1,dataToUpdate:null,updateResult:"",showUpdateMenu:!1,selectedPet:null,pet_type:"cat",breeds:[],selectedColors:[],isLoadingColors:!1,colors:[],petIndex:null,name:{value:"",errorMsg:""},gender:{value:"male",errorMsg:""},birth_date:{value:Object(h.a)(D,"isoDate"),errorMsg:""},photo:{value:"",url:"",errorMsg:""},breed_name:{value:"",errorMsg:""},petToDelete:null,isDeletingPet:!1,deletePetResult:"",deletePetFailure:""};t.default=function(){var e=Object(o.useState)(!1),t=Object(s.a)(e,2),a=t[0],r=t[1],d=Object(o.useState)(!1),u=Object(s.a)(d,2),p=u[0],j=u[1],b=N(M),h=Object(s.a)(b,2),m=h[0],O=h[1],g=Object(o.useContext)(w.a),x=Object(k.a)(),y=Object(o.useContext)(_.a).setPageIsLoading;return Object(o.useEffect)((function(){var e=!0,t=function(){var t=Object(c.a)(n.a.mark((function t(){var a;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,x("".concat("https://pet-verse-app.herokuapp.com/","receptionist/shelterpets"),"GET",null,{Authorization:"Bearer ".concat(g.token)});case 3:(a=t.sent)&&e&&O({type:"successFetchPets",data:a}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),e&&O({type:"failureFetchPets",error:t.t0.message});case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}();return t(),function(){y(!1),e=!1}}),[g.token,O,x,y]),Object(o.useEffect)((function(){y(m.isFetchingPets)}),[m.isFetchingPets,y]),Object(o.useEffect)((function(){var e=!0,t=function(){var t=Object(c.a)(n.a.mark((function t(){var a;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,x("".concat("https://pet-verse-app.herokuapp.com/","pets/breeds?pet_type=").concat(m.pet_type),"GET",null,{Authorization:"Bearer ".concat(g.token)});case 3:(a=t.sent)&&e&&O({type:"getBreedsSuccess",data:a}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),e&&O({type:"failure",data:t.t0.message});case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}();return m.isLoadingBreeds&&t(),function(){y(!1),e=!1}}),[x,g.token,O,y,m.pet_type,m.isLoadingBreeds]),Object(o.useEffect)((function(){var e=!0;e&&O({type:"getColors"});var t=function(){var t=Object(c.a)(n.a.mark((function t(){var a;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,x("".concat("https://pet-verse-app.herokuapp.com/","pets/colors"),"GET",null,{Authorization:"Bearer ".concat(g.token)});case 3:(a=t.sent)&&e&&O({type:"getColorsSuccess",data:a}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),e&&O({type:"failure",data:t.t0.message});case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}();return t(),function(){y(!1),e=!1}}),[x,g.token,O,y]),Object(o.useEffect)((function(){var e=!0,t=function(){var t=Object(c.a)(n.a.mark((function t(){var a;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,x("".concat("https://pet-verse-app.herokuapp.com/","receptionist/shelterpets/").concat(m.selectedPet&&m.selectedPet.id),"PATCH",m.dataToUpdate,{Authorization:"Bearer ".concat(g.token)});case 3:a=t.sent,e&&a&&O({type:"successUpdate",data:a.result}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),e&&O({type:"failure",error:t.t0.message});case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}();return m.isUpdating&&t(),function(){y(!1),e=!1}}),[g.token,O,x,y,m.dataToUpdate,m.isUpdating,m.selectedPet]),Object(o.useEffect)((function(){y(m.isLoadingBreeds||m.isLoadingColors||m.isUpdating||m.isDeletingPet)}),[m.isLoadingBreeds,m.isLoadingColors,m.isUpdating,y,m.isDeletingPet]),Object(o.useEffect)((function(){a||m.isDeletingPet||O({type:"selectToDelete",deleteId:null})}),[a,m.isDeletingPet,O]),Object(o.useEffect)((function(){var e=!0,t=function(){var t=Object(c.a)(n.a.mark((function t(){var a;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,x("".concat("https://pet-verse-app.herokuapp.com/","receptionist/shelterpets/").concat(m.petToDelete&&m.petToDelete),"DELETE",null,{Authorization:"Bearer ".concat(g.token)});case 3:a=t.sent,e&&a&&O({type:"deletePetSuccess",data:a}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),e&&O({type:"deletePetFailure",error:t.t0.message});case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}();return m.isDeletingPet&&t(),function(){e=!1,y(!1)}}),[g.token,O,x,y,m.isDeletingPet,m.petToDelete]),Object(f.jsxs)(f.Fragment,{children:[(m.fetchPetsFailure||m.responseError||m.deletePetFailure)&&Object(f.jsx)(F.a,{modalClass:"error",header:"Oops!!",body:m.fetchPetsFailure||m.responseError||m.deletePetFailure,dispatch:O}),(m.updateResult||m.deletePetResult)&&Object(f.jsx)(F.a,{modalClass:"success",header:"Success!!",body:m.updateResult||m.deletePetResult,dispatch:O,refresh:!0}),Object(f.jsx)("h4",{children:"Manage Pets"}),Object(f.jsxs)("div",{children:[Object(f.jsx)("div",{className:"flex-col falign-center fjust-center ",children:a&&Object(f.jsx)(i.a,{closeModal:r,dispatch:O})}),Object(f.jsx)("div",{className:"flex-col falign-center fjust-center ",children:p&&Object(f.jsx)(v,{setOpenEditModal:j,state:m,dispatch:O})}),Object(f.jsxs)(l.Table,{className:"my-table",children:[Object(f.jsx)(l.Thead,{children:Object(f.jsxs)(l.Tr,{children:[Object(f.jsx)(l.Th,{children:"ID"}),Object(f.jsx)(l.Th,{children:"Name"}),Object(f.jsx)(l.Th,{children:"Type"}),Object(f.jsx)(l.Th,{children:"Gender"}),Object(f.jsx)(l.Th,{children:"Breed"}),Object(f.jsx)(l.Th,{children:"Edit"}),Object(f.jsx)(l.Th,{children:"Delete"})]})}),Object(f.jsx)(l.Tbody,{children:m.pets.map((function(e,t){return Object(f.jsxs)(l.Tr,{children:[Object(f.jsx)(l.Td,{children:e.id}),Object(f.jsx)(l.Td,{children:e.name}),Object(f.jsx)(l.Td,{children:e.type_name}),Object(f.jsx)(l.Td,{children:e.gender}),Object(f.jsx)(l.Td,{children:e.breed_name}),Object(f.jsx)(l.Td,{children:Object(f.jsx)("button",{className:"my-great-button margin-bottom",onClick:function(){window.scrollTo(0,0),O({type:"selectPet",data:m.pets[t],index:t}),j(!0),r(!1)},children:Object(f.jsx)("i",{className:"fa-regular fa-pen-to-square"})})}),Object(f.jsx)(l.Td,{children:Object(f.jsx)("button",{className:"my-great-button margin-bottom ",onClick:function(){window.scrollTo(0,0),O({type:"selectToDelete",deleteId:e.id}),r(!0),j(!1)},children:Object(f.jsx)("i",{className:m.petToDelete&&m.petToDelete===e.id?"fa-regular fa-trash-can active":"fa-regular fa-trash-can"})})})]},t)}))})]})]})]})}},30:function(e,t,a){"use strict";var r=a(8),n=a.n(r),c=a(11),s=a(1);t.a=function(){var e=Object(s.useCallback)(function(){var e=Object(c.a)(n.a.mark((function e(t){var a,r,c,s,l,o=arguments;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=o.length>1&&void 0!==o[1]?o[1]:"GET",r=o.length>2&&void 0!==o[2]?o[2]:null,c=o.length>3&&void 0!==o[3]?o[3]:{},e.prev=3,e.next=6,fetch(t,{method:a,headers:c,body:r});case 6:return s=e.sent,e.next=9,s.json();case 9:if(l=e.sent,s.ok){e.next=12;break}throw new Error(l.error);case 12:return e.abrupt("return",l);case 15:throw e.prev=15,e.t0=e.catch(3),e.t0;case 18:case"end":return e.stop()}}),e,null,[[3,15]])})));return function(t){return e.apply(this,arguments)}}(),[]);return e}},33:function(e,t,a){"use strict";var r=a(4),n=a(55),c=a(267),s=a(1),l={initial:{y:"-100vh"},final:{y:0},exit:{y:"-100vh"}},o=a(2),i=a(0),d=l;t.a=function(e){var t=Object(s.useState)(!0),a=Object(r.a)(t,2),l=a[0],u=a[1],p=Object(o.h)();return Object(i.jsx)(i.Fragment,{children:Object(i.jsx)("div",{className:"modal modal_".concat(e.modalClass),children:Object(i.jsx)(n.a,{children:l&&Object(i.jsxs)(c.a.div,{variants:d,initial:"initial",animate:"final",exit:"exit",className:"modal-container modal-container__".concat(e.modalClass," flex-col gap-16p falign-center"),children:[Object(i.jsx)("header",{className:"modal-header modal-header__".concat(e.modalClass),children:e.header}),Object(i.jsx)("div",{className:"flex-col gap-8p modal-body modal-body__".concat(e.modalClass),children:e.body}),Object(i.jsxs)("footer",{className:"modal-footer modal-footer__".concat(e.modalClass),children:[("check"===e.modalClass||"edit"===e.modalClass)&&Object(i.jsx)("button",{onClick:function(){u(!1),setTimeout((function(){e.dispatch({type:"finalConfirm"})}),300)},className:"btn-rec modal-button modal-button__confirm",children:"Confirm "}),Object(i.jsx)("button",{onClick:function(){return u(!1),e.refresh?setTimeout((function(){window.location.reload()}),300):e.redirectTo?setTimeout((function(){p(e.redirectTo)}),300):void setTimeout((function(){e.dispatch({type:"".concat(e.modalClass,"ModalExit")})}),300)},className:"btn-rec modal-button modal-button__".concat(e.modalClass),children:"success"===e.modalClass?"OK":"check"===e.modalClass||"edit"===e.modalClass?"Cancel":"Exit"})]})]})})})})}},38:function(e,t,a){"use strict";var r=a(0);t.a=function(e){return Object(r.jsx)("span",{style:e.style,className:e.class,children:e.msg})}},56:function(e,t,a){"use strict";var r=a(0);t.a=function(e){var t=e.closeModal,a=e.dispatch;return Object(r.jsx)("div",{className:"modal-background flex falign-center fjust-center",children:Object(r.jsxs)("div",{className:"modal-container flex-col fgap-16p falign-center fjust-center",children:[Object(r.jsx)("div",{className:"x-close",children:Object(r.jsx)("button",{onClick:function(){return t(!1)},children:Object(r.jsx)("i",{className:"fa-solid fa-xmark"})})}),Object(r.jsx)("div",{className:"modal-title",children:"Are you sure you want to delete?"}),Object(r.jsxs)("div",{className:"flex-row edit-modal-buttons-container gap-24p fjust-center",children:[Object(r.jsx)("button",{onClick:function(){t(!1),a({type:"startDeleting"})},className:"btn-rec-purple",children:"Yes"}),Object(r.jsx)("button",{onClick:function(){return t(!1)},className:"btn-rec-purple",children:"No"})]})]})})}},62:function(e,t,a){"use strict";var r=a(0);t.a=function(e){return Object(r.jsxs)("div",{className:"photo-info-wrapper flex-row gap-32p falign-center",children:[Object(r.jsx)("img",{src:e.fileURL,alt:"mini-upload-icon"}),Object(r.jsxs)("div",{className:"flex-col gap-8p",children:[Object(r.jsx)("p",{children:e.fileName}),Object(r.jsxs)("span",{children:[e.fileSize,"Kbytes"]})]})]})}},63:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var r={initial:{opacity:0},final:{opacity:1,transition:{duration:1}},exit:{opacity:0,transition:{duration:.5}}}}}]);
//# sourceMappingURL=22.254bffb3.chunk.js.map